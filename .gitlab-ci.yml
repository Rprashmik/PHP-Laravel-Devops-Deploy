stages:
  - install
  - test
  - deploy

variables:
  APP_ENV: "production"
  DB_HOST: "127.0.0.1"
  DB_DATABASE: "practical_app_db"
  DB_USERNAME: "root"
  DB_PASSWORD: "your_mysql_password"

install_dependencies:
  stage: install
  script:
    - echo "Installing dependencies..."
    - composer install --no-interaction --prefer-dist
    - cp .env.example .env
    - php artisan key:generate
  artifacts:
    paths:
      - vendor/

run_tests:
  stage: test
  script:
    - echo "Running tests..."
    - php artisan test

deploy:
  stage: deploy
  script:
    - echo "Deploy step: Copy files to server or run migrations"
    - php artisan migrate --force
